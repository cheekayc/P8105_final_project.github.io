---
title: "Exploratory Analyses"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

```{r setup, message = FALSE}
knitr::opts_chunk$set(message = FALSE)
library(tidyverse)
library(lubridate)
library(plotly)
library(patchwork)
```

### Summary of the used packages and dependencies
tidyverse, lubridate, plotly, patchwork


```{r,data cleaning, message = FALSE}
bakery_df =
  read_csv("./Data/Bakery_sales.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    unit_price = str_replace(unit_price, "€", ""),
    unit_price = str_replace(unit_price, ",", "."),
    unit_price = as.numeric(unit_price),
    product_name = article) %>% 
  filter(product_name != ".") %>% 
  select(-article)
```

### Introduction & Background of data sets

We used updated version dataset of a French bakery from 2021-01-01 to 2022-09-30. The dataset provides the daily transaction details of customers. Since the dataset is still updating, we used downloaded version on 2022-12-03.

The dataset includes:

`date`: date order

`time`: time order

`ticket number`: identifier for every single transaction

`article`: name of the product sold (in French)

`quantity`: quantity sold

`unit_price`: price per product (in Euro)

`objective`: forecast the sales in order to ease the production planning

It contains `r ncol(bakery_df)` variables and `r nrow(bakery_df)` observations.

Firstly, we used `read_csv()` to import the dataset "Bakery_sales.csv", and applied `janitor::clean_names()` to change the variables' names into lower cases. Next, we tidied dataset by applying `mutate()` to remove the euro sign "€", change "," to ".", convert `unit_price` to numeric form, and renamed the `article` as `product_name`. Finally, we deleted the missing data via `filter()` and `article` via `select()`. 


### Pie Charts

A pie chart showing the percentage of each product’s sale count (top 10)
```{r}
plot_pie =
  bakery_df %>% 
  group_by(product_name) %>% 
  summarize(n_obs = n()) %>% 
  arrange(desc(n_obs)) %>% 
  head(10) %>% 
  plot_ly(labels = ~product_name, values = ~n_obs, type = 'pie', colors = "viridis") %>% 
  layout(title = 'Top 10 favoriate bakeries',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))

plot_pie
```


